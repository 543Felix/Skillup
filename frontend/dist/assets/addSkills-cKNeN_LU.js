import{u as P,Q as V,r as n,A as N,j as e,F as f,S as E,a as _,f as A,T as q,U as T,V as W,B as r,W as X,O as Y}from"./index-Do9RfUXn.js";const J=({setLoader:o,role:u})=>{const m=P(s=>u==="dev"?s.developerRegisterData._id:u==="company"?s.companyRegisterData._id:null),b=V(),[x,g]=n.useState(!1),[y,k]=n.useState(null),j=n.useRef(null),[p,w]=n.useState(null),[S,v]=n.useState(!1),[c,C]=n.useState({name:"",email:"",phoneNo:"",image:""}),[$,t]=n.useState(""),[l,D]=n.useState({name:"",email:"",phoneNo:""}),[i,z]=n.useState({name:"",email:"",phoneNo:""});n.useEffect(()=>{N.get(`/${u}/profile?id=${m}`).then(s=>{if(s&&s.data.data){const{name:a,email:d,phoneNo:h,image:F}=s.data.data;console.log("data",{name:a,email:d,phoneNo:h,image:F}),C({name:a,email:d,phoneNo:h,image:F}),z({name:a,email:d,phoneNo:h})}console.log("jkdsfa")}).catch(s=>{console.log("error = ",s)})},[$,l,m,u]);function Z(){j.current?.click()}function R(s){const a=s.target.files?.[0];if(w(a),a){const d=URL.createObjectURL(a);k(d)}}function O(s){s&&(o(!0),q(s).then(a=>{if(a){const d=a;N.post(`/${u}/uploadProfile?id=${m}`,{url:d}).then(()=>{g(!1);const h=JSON.stringify({_id:m,image:a});u==="dev"?(localStorage.setItem("developerData",h),b(T({image:d}))):u==="company"&&(localStorage.setItem("companyData",h),b(W({image:d}))),t(a.url),r.success("image uploaded  successfully")})}}).catch(a=>{console.log(a)}).finally(()=>{o(!1)}))}function I(s){const{name:a,value:d}=s.target;z(h=>({...h,[a]:d}))}function U(s){if(s.preventDefault(),!i.name||!i.email||!i.phoneNo){r.error("Please fill in every field");return}else if(i.name.match("^[A-Z][a-zA-Z]{2,28}(?: [a-zA-Z]+)*$"))if(/^[a-z0-9]+@gmail\.com$/.test(i.email))if(i.phoneNo.match("^\\d{10}$"))console.log("entered to the else"),N.post(`/${u}/profileData?id=${m}`,{formData:i}).then(a=>{a.status===200&&(r.success("Profile updated"),D(a.data.data),console.log("data = ",a.data.data))}).catch(a=>{r.error(a.message)}).finally(()=>{v(!1)});else{r.error("Enter a valid phone number");return}else{console.log("invalid email address"),r.error("Invalid email address.");return}else{r.error("This field should start with a capital letter with at least 3 characters");return}}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-start-1 bg-slate-500 bg-opacity-[15%] rounded-[15px] grid grid-rows-2 shadow-lg shadow-black",children:[e.jsx("div",{className:"row-start-1 flex justify-center items-center",children:c&&c.image?e.jsx("img",{src:`${c.image}`,className:"h-20 w-20 rounded-full",onClick:()=>{g(!0)}}):e.jsx("div",{className:"p-4 border-4 border-white rounded-full",onClick:()=>{g(!0)},children:e.jsx(f,{className:"h-16 text-white",icon:E})})}),e.jsxs("div",{className:"row-start-2 px-4 py-2 border-t items-center grid grid-rows-3  grid-cols-3",children:[e.jsx("div",{className:"row-start-1 col-start-3 ml-8 border-2 rounded-full h-6 w-6 text-white  border-white flex justify-center items-center",onClick:()=>v(!0),children:e.jsx(f,{className:"flex items-center h-3  w-3",icon:_})}),c&&e.jsxs(e.Fragment,{children:[e.jsx("input",{defaultValue:c.name,type:"text",className:"text-lg font-bold  row-start-1 col-span-2 bg-transparent  border-none focus:outline-none focus:ring-0 text-white",readOnly:!0}),e.jsx("input",{defaultValue:c.email,type:"text",className:"text-base font-light  row-start-2 col-span-3 bg-transparent border-none focus:outline-none focus:ring-0 text-white ",readOnly:!0}),e.jsx("input",{defaultValue:c.phoneNo,type:"text",className:"text-base font-light  row-start-3 col-span-2 bg-transparent border-none focus:outline-none focus:ring-0 text-white ",readOnly:!0})]})]})]}),x&&e.jsx("div",{className:"fixed top-0 left-0 z-30 w-full h-full flex justify-center items-center bg-black bg-opacity-45",children:e.jsxs("div",{className:"h-[350px] w-[450px] bg-[#1F2937] rounded-[25px] p-5 ",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"text-white text-2xl font-semibold",children:"Edit photo "}),e.jsx(f,{className:"h-6 text-white",icon:A,onClick:()=>g(!1)})]}),e.jsx("div",{className:"flex items-center",children:y?e.jsx("img",{src:y,alt:"selected",className:"h-[130px] mt-10 w-[130px]"}):e.jsx(e.Fragment,{children:c.image?e.jsx("img",{src:`${c.image}`,alt:"selected",className:"h-[130px] mt-10 w-[130px] rounded-full"}):e.jsx("div",{className:"border-4 h-[130px] mt-10 w-[130px] flex justify-center items-center border-white rounded-full",children:e.jsx(f,{className:"h-20 text-white",icon:E})})})}),e.jsx("input",{ref:j,type:"file",name:"",id:"",hidden:!0,onChange:R}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{className:"text-xl text-lightViolet font-semibold  mr-4 ",onClick:Z,children:"Change Image"}),e.jsx("button",{className:"bg-violet px-5 py-2 mt-2 text-white",onClick:()=>O(p),children:"Save Image"})]})]})}),S&&e.jsx("div",{className:"fixed top-0 left-0 z-30 w-full h-full flex justify-center items-center bg-black bg-opacity-45",children:e.jsxs("div",{className:"h-[350px] w-[450px] bg-[#1F2937] rounded-[25px] p-5 ",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h1",{className:"text-white text-2xl font-semibold",children:"Edit Data "}),e.jsx(f,{className:"h-6 text-white",icon:A,onClick:()=>v(!1)})]}),e.jsxs("form",{className:"p-8 grid h-[300px] space-y-2 text-white",children:[e.jsx("input",{value:i.name,name:"name",type:"text",className:"border-2 border-white bg-transparent rounded-[10px] pl-4 focus:outline-none focus:ring-0 focus:border-white",onChange:s=>I(s),required:!0,pattern:"^[A-Z][a-zA-Z]{2,28}(?: [a-zA-Z]+)*$",title:"Name must be at least 3 characters long, start with a capital letter, and contain only alphabets."}),e.jsx("input",{value:i.email,name:"email",type:"text",className:"border-2 border-white bg-transparent rounded-[10px] pl-4 focus:outline-none focus:ring-0 focus:border-white",onChange:I,required:!0,pattern:"^[a-z0-9]+@gmail\\.com$",title:"Enter a valid email address"}),e.jsx("input",{value:i.phoneNo,name:"phoneNo",type:"text",className:"border-2 border-white bg-transparent rounded-[10px] pl-4 focus:outline-none focus:ring-0 focus:border-white",onChange:I,required:!0,pattern:"^\\d{10}$",title:"Enter a valid contac no"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("button",{className:"bg-violet self-end px-4 py-2 rounded-[25px]",onClick:U,children:"Save changes"})})]})]})})]})},L=({role:o})=>{const[u,m]=n.useState(!1),b=P(t=>o==="dev"?t.developerRegisterData._id:t.companyRegisterData._id),x=o==="dev"?"Skills":o==="company"?"Specialties":"",[g,y]=n.useState([]),[k,j]=n.useState(""),[p,w]=n.useState([]),[S,v]=n.useState([]);n.useEffect(()=>{N.get(`/${o}/profile?id=${b}`).then(t=>{if(t.data.data){const l=o==="dev"?t.data.data.skills:o==="company"?t.data.data.specialties:"";y(l),w(()=>[...l])}})},[b,S,x,o]);function c(t){const l=[...p];l.splice(t,1),w([...l])}function C(t){if(t.trim().length===0){r.error(`cannot add empty string as a ${x}`);return}if(t.match(/^\s*[a-zA-Z0-9 ]+\s*(,\s*[a-zA-Z0-9 ]+\s*)*$/)){const l=p.length,D=t.split(",").filter(i=>i.trim()!==""&&!p.includes(i));if(l>20){r.error(`maximum ${x} allowded is 20`);return}w([...p,...D]),j("")}else{r.error(`You can add ${x} one by one or separated by commas without any special characters.`);return}}function $(t){t.preventDefault(),N.post(`/${o}/update${x}?id=${b}`,{data:p}).then(l=>{v([...l.data.data]),r.success("skill updated in the profile"),m(!1)}).catch(l=>{r.error(l.message)})}return e.jsxs(e.Fragment,{children:[u&&e.jsx("div",{className:"fixed top-0 pt-0 left-0 z-30 w-full h-full flex justify-center items-center bg-black bg-opacity-45 ",children:e.jsxs("div",{className:"h-[auto] w-[550px] bg-[#1F2937] rounded-[25px] justify-center items-center p-5 ",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h1",{className:"text-white text-2xl font-semibold",children:["Edit ",x]}),e.jsx(f,{className:"h-6 text-white hover:text-violet",icon:A,onClick:()=>m(!1)})]}),e.jsxs("div",{className:`my-10  bg-white\r
    h-[auto] w-[510px] p-4  rounded-[25px]`,children:[e.jsx("div",{className:"flex text-violet w-[500px] flex-wrap",children:p.length>0&&p.map((t,l)=>e.jsxs("div",{className:"flex border-2 border-violet rounded-[15px] items-center justify-center px-2 py-1 mt-2 mr-2 transform hover:scale-105 transition-transform duration-300",children:[e.jsx("button",{className:"text-sm px-2",children:t}),e.jsx(f,{className:"h-4 text-violet pr-2",icon:X,onClick:()=>{c(l)}})]},l))}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:k,className:"mt-3 w-[450px] h-10 rounded-[15px] border-2 focus:outline-none border-violet bg-transparent text-black pl-5 focus:ring-0 focus:border-violet",onChange:t=>j(t.target.value),pattern:"^\\s*[a-zA-Z0-9 ]+\\s*(,\\s*[a-zA-Z0-9 ]+\\s*)*$",title:"You can add skills one by one or separated by commas without any special characters."}),e.jsx("button",{className:"bg-violet px-3 absolute right-[29px] mt-[12px] h-[40px] rounded-r-[15px] items-center justify-center border border-violet",onClick:()=>C(k),children:"Add +"})]})]}),e.jsx("div",{className:"flex flex-col",children:e.jsx("button",{className:"self-end bg-violet px-3 py-2 rounded-[25px]",onClick:$,children:"Save changes"})})]})}),e.jsxs("div",{className:"row-start-2 bg-slate-500 bg-opacity-[15%] shadow-lg shadow-black rounded-[15px] p-7 mt-3 ",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-2xl text-white font-bold font-serif",children:[x," :"]}),e.jsx("div",{className:"flex items-end",onClick:()=>m(!0),children:e.jsx("div",{className:"border-2 rounded-full h-7 w-7 text-white border-white  flex justify-center items-center",children:e.jsx(f,{className:"flex items-center h-3  w-3",icon:Y})})})]}),e.jsx("div",{className:"p-4",children:g&&g.map((t,l)=>e.jsx("button",{className:"justify-center items-center bg-transparent border-2 border-violet text-white px-4 py-[6px]  mr-3 mb-3 rounded-[8px]",children:t},l))})]})]})};export{L as A,J as P};
